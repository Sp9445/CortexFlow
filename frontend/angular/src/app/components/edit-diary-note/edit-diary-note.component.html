<div class="min-h-screen bg-gray-50">
	<!-- Header with Back Button -->
	<div class="bg-white shadow-sm border-b border-gray-200">
		<div class="max-w-3xl mx-auto px-4 py-4 flex items-center">
			<button (click)="onBack()" class="text-blue-600 hover:text-blue-800 font-medium flex items-center gap-2">
				‚Üê Back
			</button>
			<h1 class="text-2xl font-semibold text-gray-900 ml-4">
				{{ entryId === '0' ? 'New Note' : 'Edit Note' }}
			</h1>
		</div>
	</div>

	<!-- Main Content -->
	<div class="max-w-3xl mx-auto px-4 py-8">
		<!-- Loading State -->
		<div *ngIf="isLoading" class="text-center py-8">
			<p class="text-gray-600">Loading entry...</p>
		</div>

		<!-- Error Message -->
		<div *ngIf="errorMessage && !isLoading" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
			<p class="text-sm text-red-700">{{ errorMessage }}</p>
		</div>

		<!-- Success Message -->
		<div *ngIf="successMessage" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
			<p class="text-sm text-green-700">{{ successMessage }}</p>
		</div>

		<!-- Note Section -->
		<div *ngIf="!isLoading" class="space-y-6">
			<!-- Original Text Editor -->
			<div class="bg-white rounded-lg shadow-md p-6">
				<div class="mb-4">
					<label class="block text-sm font-medium text-gray-700 mb-2">Note</label>
					<textarea [(ngModel)]="rawText" name="rawText"
						placeholder="Write your diary entry here..."
						rows="10"
						class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"></textarea>
					<div class="text-xs text-gray-500 mt-2">
						{{ getTextLength() }} characters
						<span *ngIf="!canShowActions" class="text-blue-600 ml-2">(Minimum 25 characters required)</span>
					</div>
				</div>

				<!-- Action Buttons -->
				 <div>
  Improving: {{ isImproving }} |
  CanShow: {{ canShowActions }}
</div>
				<div *ngIf="canShowActions" class="flex gap-3">
					<button (click)="onImprove()" [disabled]="isImproving || isSaving"
						class="flex-1 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium transition">
						{{ isImproving ? 'Improving...' : '‚ú® Improve' }}
					</button>
					<button (click)="onSave()" [disabled]="isSaving || isImproving"
						class="flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium transition">
						{{ isSaving ? 'Saving...' : 'üíæ Save' }}
					</button>
				</div>
			</div>

			<!-- Improved Text Section (shown below save button when improved) -->
			<div *ngIf="showImprovedView && improvedText" class="bg-white rounded-lg shadow-md p-6 border-2 border-green-200">
				<div class="mb-4">
					<label class="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
						<span>Improved Text</span>
						<span class="inline-block bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded">
							AI Improved
						</span>
					</label>
					<div class="p-4 bg-green-50 rounded-lg border border-green-200 text-gray-700 whitespace-pre-wrap break-words">
						{{ improvedText }}
					</div>
				</div>

				<!-- Action Buttons for Improved Text -->
				<div class="flex gap-3">
					<button (click)="onEditImproved()" [disabled]="isSaving"
						class="flex-1 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium transition">
						‚úèÔ∏è Edit This Version
					</button>
					<button (click)="onSave()" [disabled]="isSaving || isImproving"
						class="flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white py-2 rounded-lg font-medium transition">
						{{ isSaving ? 'Saving...' : 'üíæ Save' }}
					</button>
				</div>
			</div>
		</div>
	</div>
</div>
